<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login - Neuronix AI JobFlow</title>
    <link rel="stylesheet" href="style.css" />
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar">
      <div class="container nav-content">
        <a href="index.html" class="nav-brand">
          <i data-lucide="brain" class="text-primary"></i>
          <span
            style="
              background: linear-gradient(
                to right,
                hsl(var(--primary)),
                hsl(var(--accent))
              );
              -webkit-background-clip: text;
              background-clip: text;
              color: transparent;
            "
            >Neuronix AI Solutions</span
          >
        </a>
        <div class="nav-links" style="gap: 1rem">
          <a href="index.html" class="nav-link">Home</a>
          <a href="services.html" class="nav-link">Services</a>
          <a href="team.html" class="nav-link">Team</a>
          <a href="contact.html" class="nav-link">Contact</a>
          <button
            class="theme-toggle"
            type="button"
            aria-label="Toggle color theme"
          >
            <i data-lucide="moon" class="theme-icon theme-icon-moon"></i>
            <i data-lucide="sun" class="theme-icon theme-icon-sun"></i>
          </button>
          <a href="login.html" class="btn btn-outline">Try for Free</a>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <div class="min-h-screen pt-32 pb-20">
      <div class="container max-w-md">
        <div class="text-center mb-8">
          <div class="flex items-center justify-center gap-3 mb-4">
            <i
              data-lucide="log-in"
              style="width: 40px; height: 40px"
              class="text-primary"
            ></i>
          </div>
          <h1 class="text-4xl font-bold mb-4">
            Welcome <span class="text-primary">Back</span>
          </h1>
          <p class="text-muted-foreground">Sign in to access your account</p>
        </div>

        <div class="card">
          <form id="loginForm" class="space-y-6">
            <div class="space-y-2">
              <label for="email" class="label">Email</label>
              <input
                type="email"
                id="email"
                class="input"
                placeholder="your@email.com"
                required
              />
            </div>

            <div class="space-y-2">
              <label for="password" class="label">Password</label>
              <input
                type="password"
                id="password"
                class="input"
                placeholder="••••••••"
                required
              />
            </div>

            <div class="flex justify-between items-center">
              <div class="flex items-center gap-2">
                <input type="checkbox" id="remember" />
                <label for="remember" class="label" style="font-weight: normal"
                  >Remember me</label
                >
              </div>
              <a
                href="forgot-password.html"
                class="text-primary"
                style="font-size: 0.875rem; text-decoration: none"
                >Forgot password?</a
              >
            </div>

            <button
              type="submit"
              class="btn btn-primary w-full btn-lg"
              id="submitBtn"
            >
              Login
            </button>
          </form>

          <div class="text-center" style="margin-top: 1.5rem">
            <p class="text-muted-foreground" style="font-size: 0.875rem">
              Don't have an account?
              <a
                href="signup.html"
                class="text-primary font-bold"
                style="text-decoration: none"
                >Sign up</a
              >
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container footer-content">
        <div class="flex items-center gap-2">
          <i data-lucide="brain" class="text-primary"></i>
          <span class="font-bold text-lg">Neuronix AI Solutions</span>
        </div>
        <p
          class="text-muted-foreground text-center"
          style="font-size: 0.875rem"
        >
          Empowering the Future with AI
        </p>
        <p class="text-muted-foreground" style="font-size: 0.75rem">
          © 2025 Neuronix AI Solutions. All rights reserved.
        </p>
      </div>
    </footer>

    <script src="theme-toggle.js"></script>
    <script>
      lucide.createIcons();
    </script>

    <script type="module">
      import { showToast, apiCall } from "./app.js";

      const form = document.getElementById("loginForm");
      const submitBtn = document.getElementById("submitBtn");
      const emailInput = document.getElementById("email");
      const rememberCheckbox = document.getElementById("remember");

      // Check for remembered email on load
      document.addEventListener('DOMContentLoaded', () => {
          const rememberedEmail = localStorage.getItem('rememberedEmail');
          if (rememberedEmail) {
              emailInput.value = rememberedEmail;
              rememberCheckbox.checked = true;
          }
      });

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = emailInput.value;
        const password = document.getElementById("password").value;
        const rememberMe = rememberCheckbox.checked;

        submitBtn.disabled = true;
        submitBtn.textContent = "Logging in...";

        try {
          const response = await apiCall("/api/auth/login", "POST", {
            email,
            password,
          });

          if (response.status === "success") {
            // Handle Remember Me
            if (rememberMe) {
                localStorage.setItem("user", JSON.stringify(response.user));
                localStorage.setItem("rememberedEmail", email);
            } else {
                sessionStorage.setItem("user", JSON.stringify(response.user));
                localStorage.removeItem("rememberedEmail");
                // Ensure we don't have it in localStorage if they unchecked it
                localStorage.removeItem("user"); 
            }
            
            showToast("Login successful!");
            setTimeout(() => {
              window.location.href = "index.html";
            }, 1000);
          } else {
            throw new Error(response.message || "Failed to login");
          }
        } catch (error) {
          showToast(error.message || "Failed to login", "error");
          submitBtn.disabled = false;
          submitBtn.textContent = "Login";
        }
      });
    </script>
  </body>
</html>
